<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ·±å…¥äº†è§£ - å‡½æ•°è°ƒç”¨ï¼ˆFCï¼‰</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header class="top-header">
        <div class="logo">
            <span class="logo-icon">ğŸ¤–</span>
            <span class="logo-text">ç”Ÿæˆå¼AIå…¥é—¨è¯¾ç¨‹</span>
        </div>
    </header>

    <main class="deep-page">
        <div class="deep-header">
            <a href="../index.html#ch07" class="back-btn">
                <span>â†</span>
                <span>è¿”å›è¯¾ç¨‹é¦–é¡µ</span>
            </a>
        </div>

        <h1 class="deep-title">æ·±å…¥äº†è§£ï¼šå‡½æ•°è°ƒç”¨ï¼ˆFCï¼‰</h1>

        <div class="deep-content">
            <h2>å‡½æ•°è°ƒç”¨æ¨¡æ‹Ÿæ¼”ç¤º</h2>
            <p>ä½“éªŒLLMå¦‚ä½•åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼š</p>

            <div class="prompt-generator">
                <div class="form-group">
                    <label class="form-label">è¾“å…¥é—®é¢˜</label>
                    <input id="fcInput" class="form-input" type="text" placeholder="ä¾‹å¦‚ï¼šä»Šå¤©ä¸Šæµ·å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ">
                </div>
                <button id="fcBtn" class="btn-generate">åˆ†æå¹¶æ‰§è¡Œ</button>
                <div id="fcResult" class="prompt-preview" style="display: none;"></div>
            </div>

            <h2>å‡½æ•°è°ƒç”¨ä»£ç ç¤ºä¾‹</h2>

            <div class="code-demo">
                <div class="code-header">
                    <span class="code-title">Function Callingç¤ºä¾‹ï¼ˆOpenAIæ ¼å¼ï¼‰</span>
                    <button class="copy-btn" data-copy-target="code-fc">å¤åˆ¶ä»£ç </button>
                </div>
                <pre class="code-block" id="code-fc"><code><span class="code-keyword">from</span> openai <span class="code-keyword">import</span> OpenAI

client = OpenAI(api_key=<span class="code-string">"your-api-key"</span>)

<span class="code-comment"># å®šä¹‰å¯ç”¨çš„å·¥å…·ï¼ˆå‡½æ•°ï¼‰</span>
tools = [
    {
        <span class="code-string">"type"</span>: <span class="code-string">"function"</span>,
        <span class="code-string">"function"</span>: {
            <span class="code-string">"name"</span>: <span class="code-string">"get_weather"</span>,
            <span class="code-string">"description"</span>: <span class="code-string">"è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯"</span>,
            <span class="code-string">"parameters"</span>: {
                <span class="code-string">"type"</span>: <span class="code-string">"object"</span>,
                <span class="code-string">"properties"</span>: {
                    <span class="code-string">"location"</span>: {
                        <span class="code-string">"type"</span>: <span class="code-string">"string"</span>,
                        <span class="code-string">"description"</span>: <span class="code-string">"åŸå¸‚åç§°ï¼Œä¾‹å¦‚ï¼šåŒ—äº¬ã€ä¸Šæµ·"</span>
                    }
                },
                <span class="code-string">"required"</span>: [<span class="code-string">"location"</span>]
            }
        }
    }
]

<span class="code-comment"># å‘é€è¯·æ±‚</span>
response = client.chat.completions.<span class="code-function">create</span>(
    model=<span class="code-string">"gpt-4"</span>,
    messages=[
        {<span class="code-string">"role"</span>: <span class="code-string">"user"</span>, <span class="code-string">"content"</span>: <span class="code-string">"ä»Šå¤©ä¸Šæµ·å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>}
    ],
    tools=tools
)

<span class="code-comment"># æ£€æŸ¥æ˜¯å¦éœ€è¦è°ƒç”¨å‡½æ•°</span>
<span class="code-keyword">if</span> response.choices[<span class="code-number">0</span>].message.tool_calls:
    <span class="code-comment"># æå–å‡½æ•°è°ƒç”¨ä¿¡æ¯</span>
    tool_call = response.choices[<span class="code-number">0</span>].message.tool_calls[<span class="code-number">0</span>]
    function_name = tool_call.function.name
    function_args = <span class="code-function">eval</span>(tool_call.function.arguments)

    <span class="code-comment"># æ‰§è¡Œå‡½æ•°ï¼ˆè¿™é‡Œéœ€è¦ä½ è‡ªå·±å®ç°ï¼‰</span>
    <span class="code-keyword">if</span> function_name == <span class="code-string">"get_weather"</span>:
        weather_result = <span class="code-function">get_weather</span>(function_args[<span class="code-string">"location"</span>])
        <span class="code-function">print</span>(f<span class="code-string">"å¤©æ°”æŸ¥è¯¢ç»“æœï¼š{weather_result}"</span>)</code></pre>
            </div>

            <h2>å¸¸è§åº”ç”¨åœºæ™¯</h2>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0;">
                <div style="background: white; padding: 20px; border-radius: 10px; border-left: 4px solid var(--primary-color);">
                    <div style="font-size: 2rem; margin-bottom: 10px;">ğŸŒ¤ï¸</div>
                    <h3 style="margin-bottom: 8px;">å®æ—¶æŸ¥è¯¢</h3>
                    <p style="font-size: 0.9rem; color: var(--text-secondary);">å¤©æ°”ã€è‚¡ç¥¨ã€æ–°é—»ç­‰å®æ—¶æ•°æ®æŸ¥è¯¢</p>
                </div>
                <div style="background: white; padding: 20px; border-radius: 10px; border-left: 4px solid var(--secondary-color);">
                    <div style="font-size: 2rem; margin-bottom: 10px;">ğŸ’¾</div>
                    <h3 style="margin-bottom: 8px;">æ•°æ®åº“æ“ä½œ</h3>
                    <p style="font-size: 0.9rem; color: var(--text-secondary);">è‡ªç„¶è¯­è¨€æŸ¥è¯¢SQLæ•°æ®åº“</p>
                </div>
                <div style="background: white; padding: 20px; border-radius: 10px; border-left: 4px solid var(--accent-color);">
                    <div style="font-size: 2rem; margin-bottom: 10px;">ğŸ“…</div>
                    <h3 style="margin-bottom: 8px;">æ—¥ç¨‹ç®¡ç†</h3>
                    <p style="font-size: 0.9rem; color: var(--text-secondary);">åˆ›å»ºæé†’ã€å®‰æ’ä¼šè®®</p>
                </div>
                <div style="background: white; padding: 20px; border-radius: 10px; border-left: 4px solid var(--success-color);">
                    <div style="font-size: 2rem; margin-bottom: 10px;">ğŸ”§</div>
                    <h3 style="margin-bottom: 8px;">å·¥å…·è°ƒç”¨</h3>
                    <p style="font-size: 0.9rem; color: var(--text-secondary);">è®¡ç®—å™¨ã€å‘é€é‚®ä»¶ã€APIè°ƒç”¨</p>
                </div>
            </div>

            <h2>å‡½æ•°è°ƒç”¨ vs ç›´æ¥ç”Ÿæˆ</h2>

            <table style="width:100%; border-collapse: collapse; margin: 20px 0;">
                <tr style="background: var(--bg-tertiary);">
                    <th style="padding: 12px; border: 1px solid var(--border-color);">æ–¹é¢</th>
                    <th style="padding: 12px; border: 1px solid var(--border-color);">ç›´æ¥ç”Ÿæˆ</th>
                    <th style="padding: 12px; border: 1px solid var(--border-color);">å‡½æ•°è°ƒç”¨</th>
                </tr>
                <tr>
                    <td style="padding: 12px; border: 1px solid var(--border-color);">å®æ—¶æ€§</td>
                    <td style="padding: 12px; border: 1px solid var(--border-color);">ä¾èµ–è®­ç»ƒæ•°æ®</td>
                    <td style="padding: 12px; border: 1px solid var(--border-color);">è·å–å®æ—¶æ•°æ®</td>
                </tr>
                <tr>
                    <td style="padding: 12px; border: 1px solid var(--border-color);">å‡†ç¡®æ€§</td>
                    <td style="padding: 12px; border: 1px solid var(--border-color);">å¯èƒ½äº§ç”Ÿå¹»è§‰</td>
                    <td style="padding: 12px; border: 1px solid var(--border-color);">å·¥å…·è¿”å›å‡†ç¡®æ•°æ®</td>
                </tr>
                <tr>
                    <td style="padding: 12px; border: 1px solid var(--border-color);">é€‚ç”¨åœºæ™¯</td>
                    <td style="padding: 12px; border: 1px solid var(--border-color);">é€šç”¨é—®ç­”ã€åˆ›ä½œ</td>
                    <td style="padding: 12px; border: 1px solid var(--border-color);">éœ€è¦å‡†ç¡®æ•°æ®çš„ä»»åŠ¡</td>
                </tr>
            </table>

            <h2>ç« èŠ‚æµ‹éªŒ</h2>

            <div class="quiz-container" data-quiz-id="ch07-quiz-1">
                <div class="quiz-question">1. å‡½æ•°è°ƒç”¨ï¼ˆFunction Callingï¼‰çš„ä¸»è¦ä½œç”¨æ˜¯ï¼Ÿ</div>
                <div class="quiz-options">
                    <label class="quiz-option">
                        <input type="radio" name="ch07q1" value="0" class="quiz-radio">
                        <span>åŠ å¿«AIå“åº”é€Ÿåº¦</span>
                    </label>
                    <label class="quiz-option">
                        <input type="radio" name="ch07q1" value="1" class="quiz-radio">
                        <span>è®©AIèƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨å·¥å…·ï¼Œè·å–å®æ—¶æ•°æ®</span>
                    </label>
                    <label class="quiz-option">
                        <input type="radio" name="ch07q1" value="2" class="quiz-radio">
                        <span>å‡å°‘APIè°ƒç”¨æˆæœ¬</span>
                    </label>
                </div>
                <button class="submit-quiz-btn">æäº¤ç­”æ¡ˆ</button>
                <div class="quiz-feedback"></div>
            </div>

            <div class="quiz-container" data-quiz-id="ch07-quiz-2">
                <div class="quiz-question">2. å‡½æ•°è°ƒç”¨ç›¸æ¯”ç›´æ¥ç”Ÿæˆçš„ä¼˜åŠ¿æ˜¯ï¼Ÿ</div>
                <div class="quiz-options">
                    <label class="quiz-option">
                        <input type="radio" name="ch07q2" value="0" class="quiz-radio">
                        <span>é€Ÿåº¦æ›´å¿«</span>
                    </label>
                    <label class="quiz-option">
                        <input type="radio" name="ch07q2" value="1" class="quiz-radio">
                        <span>èƒ½è·å–å®æ—¶å‡†ç¡®æ•°æ®ï¼Œé¿å…å¹»è§‰</span>
                    </label>
                    <label class="quiz-option">
                        <input type="radio" name="ch07q2" value="2" class="quiz-radio">
                        <span>å®Œå…¨å…è´¹</span>
                    </label>
                </div>
                <button class="submit-quiz-btn">æäº¤ç­”æ¡ˆ</button>
                <div class="quiz-feedback"></div>
            </div>

            <div class="quiz-container" data-quiz-id="ch07-quiz-3">
                <div class="quiz-question">3. ä»¥ä¸‹å“ªä¸ªæ˜¯å‡½æ•°è°ƒç”¨çš„å…¸å‹åº”ç”¨åœºæ™¯ï¼Ÿ</div>
                <div class="quiz-options">
                    <label class="quiz-option">
                        <input type="radio" name="ch07q3" value="0" class="quiz-radio">
                        <span>åˆ›æ„å†™ä½œ</span>
                    </label>
                    <label class="quiz-option">
                        <input type="radio" name="ch07q3" value="1" class="quiz-radio">
                        <span>å®æ—¶å¤©æ°”æŸ¥è¯¢</span>
                    </label>
                    <label class="quiz-option">
                        <input type="radio" name="ch07q3" value="2" class="quiz-radio">
                        <span>é—²èŠå¯¹è¯</span>
                    </label>
                </div>
                <button class="submit-quiz-btn">æäº¤ç­”æ¡ˆ</button>
                <div class="quiz-feedback"></div>
            </div>

            <div class="quiz-container" data-quiz-id="ch07-quiz-4">
                <div class="quiz-question">4. åœ¨Function Callingä¸­ï¼ŒLLMçš„è§’è‰²æ˜¯ï¼Ÿ</div>
                <div class="quiz-options">
                    <label class="quiz-option">
                        <input type="radio" name="ch07q4" value="0" class="quiz-radio">
                        <span>ç›´æ¥æ‰§è¡Œå‡½æ•°</span>
                    </label>
                    <label class="quiz-option">
                        <input type="radio" name="ch07q4" value="1" class="quiz-radio">
                        <span>åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨å‡½æ•°ï¼Œå¹¶æå–å‡½æ•°å‚æ•°</span>
                    </label>
                    <label class="quiz-option">
                        <input type="radio" name="ch07q4" value="2" class="quiz-radio">
                        <span>ç”Ÿæˆå‡½æ•°ä»£ç </span>
                    </label>
                </div>
                <button class="submit-quiz-btn">æäº¤ç­”æ¡ˆ</button>
                <div class="quiz-feedback"></div>
            </div>
        </div>

        <!-- è¿”å›é¦–é¡µæŒ‰é’® -->
        <div style="text-align: center; margin-top: 40px; margin-bottom: 20px;">
            <a href="../index.html" class="back-btn" style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: var(--primary-color); color: white; text-decoration: none; border-radius: 8px; font-weight: 500;">
                <span>ğŸ </span>
                <span>è¿”å›è¯¾ç¨‹é¦–é¡µ</span>
            </a>
        </div>

        <!-- ç¤¾äº¤åˆ†äº« -->
        <div class="share-buttons">
            <a href="#" class="share-btn share-wechat" data-share-type="wechat">
                <span>ğŸ’¬</span>
                <span>åˆ†äº«åˆ°å¾®ä¿¡</span>
            </a>
            <a href="#" class="share-btn share-weibo" data-share-type="weibo">
                <span>ğŸ“±</span>
                <span>åˆ†äº«åˆ°å¾®åš</span>
            </a>
            <a href="#" class="share-btn share-copy" data-share-type="copy">
                <span>ğŸ”—</span>
                <span>å¤åˆ¶é“¾æ¥</span>
            </a>
        </div>
    </main>

    <script src="../js/main.js"></script>
    <script>
        // å‡½æ•°è°ƒç”¨æ¨¡æ‹Ÿ
        document.getElementById('fcBtn').addEventListener('click', () => {
            const input = document.getElementById('fcInput').value.trim();
            const result = document.getElementById('fcResult');

            if (!input) {
                alert('è¯·è¾“å…¥é—®é¢˜');
                return;
            }

            const lower = input.toLowerCase();

            // åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨å‡½æ•°
            let needsFunction = false;
            let functionName = '';
            let functionParams = {};
            let explanation = '';

            if (lower.includes('å¤©æ°”') || lower.includes('æ°”æ¸©')) {
                needsFunction = true;
                functionName = 'get_weather';
                // æå–åŸå¸‚å
                const cities = ['åŒ—äº¬', 'ä¸Šæµ·', 'æ·±åœ³', 'æ­å·', 'æˆéƒ½'];
                for (const city of cities) {
                    if (input.includes(city)) {
                        functionParams.location = city;
                        break;
                    }
                }
                if (!functionParams.location) {
                    functionParams.location = 'æœªçŸ¥åŸå¸‚';
                }
                explanation = `LLMè¯†åˆ«å‡ºè¿™æ˜¯ä¸€ä¸ªå¤©æ°”æŸ¥è¯¢è¯·æ±‚ï¼Œéœ€è¦è°ƒç”¨å¤–éƒ¨APIè·å–å®æ—¶æ•°æ®ã€‚`;
            } else if (lower.includes('è®¡ç®—') || /\d+\s*[\+\-\*\/]\s*\d+/.test(input)) {
                needsFunction = true;
                functionName = 'calculator';
                explanation = `LLMè¯†åˆ«å‡ºè¿™æ˜¯ä¸€ä¸ªæ•°å­¦è®¡ç®—è¯·æ±‚ï¼Œéœ€è¦è°ƒç”¨è®¡ç®—å™¨å‡½æ•°ã€‚`;
            } else if (lower.includes('å‡ ç‚¹') || lower.includes('æ—¶é—´')) {
                needsFunction = true;
                functionName = 'get_time';
                explanation = `LLMè¯†åˆ«å‡ºè¿™æ˜¯ä¸€ä¸ªæ—¶é—´æŸ¥è¯¢è¯·æ±‚ï¼Œéœ€è¦è°ƒç”¨ç³»ç»Ÿæ—¶é—´å‡½æ•°ã€‚`;
            } else {
                explanation = `LLMåˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªå¸¸è§„å¯¹è¯ï¼Œä¸éœ€è¦è°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼Œç›´æ¥ç”Ÿæˆå›å¤å³å¯ã€‚`;
            }

            // æ˜¾ç¤ºç»“æœ
            let output = `ğŸ“Š åˆ†æç»“æœ\n\n`;
            output += `è¾“å…¥ï¼š${input}\n\n`;
            output += `LLMåˆ†æï¼š${explanation}\n\n`;

            if (needsFunction) {
                output += `âœ… éœ€è¦è°ƒç”¨å‡½æ•°\n`;
                output += `å‡½æ•°åï¼š${functionName}\n`;
                if (Object.keys(functionParams).length > 0) {
                    output += `å‚æ•°ï¼š${JSON.stringify(functionParams, null, 2)}\n`;
                }
                output += `\nä¸‹ä¸€æ­¥ï¼šå¤–éƒ¨ç³»ç»Ÿæ‰§è¡Œè¯¥å‡½æ•°ï¼Œç„¶åå°†ç»“æœè¿”å›ç»™LLMï¼ŒLLMç»„ç»‡è¯­è¨€å›å¤ç”¨æˆ·ã€‚`;
            } else {
                output += `âŒ ä¸éœ€è¦è°ƒç”¨å‡½æ•°\n`;
                output += `LLMç›´æ¥ç”Ÿæˆå›å¤ã€‚`;
            }

            result.textContent = output;
            result.style.display = 'block';
        });

        // ç« èŠ‚æµ‹éªŒé€»è¾‘
        const ch07QuizAnswers = {
            'ch07-quiz-1': { correct: '1', explanation: 'æ­£ç¡®ï¼å‡½æ•°è°ƒç”¨çš„ä¸»è¦ä½œç”¨æ˜¯è®©AIèƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨å·¥å…·ï¼Œè·å–å®æ—¶æ•°æ®ã€‚è¿™æ ·AIå°±èƒ½çªç ´è®­ç»ƒæ•°æ®çš„é™åˆ¶ï¼Œè·å¾—æœ€æ–°ä¿¡æ¯ã€‚' },
            'ch07-quiz-2': { correct: '1', explanation: 'æ­£ç¡®ï¼å‡½æ•°è°ƒç”¨èƒ½è·å–å®æ—¶å‡†ç¡®æ•°æ®ï¼Œé¿å…å¹»è§‰ã€‚ç›´æ¥ç”Ÿæˆä¾èµ–è®­ç»ƒæ•°æ®ä¸”å¯èƒ½äº§ç”Ÿå¹»è§‰ï¼Œè€Œå‡½æ•°è°ƒç”¨é€šè¿‡å·¥å…·è¿”å›å‡†ç¡®ç»“æœã€‚' },
            'ch07-quiz-3': { correct: '1', explanation: 'æ­£ç¡®ï¼å®æ—¶å¤©æ°”æŸ¥è¯¢æ˜¯å‡½æ•°è°ƒç”¨çš„å…¸å‹åº”ç”¨åœºæ™¯ã€‚å…¶ä»–å…¸å‹åœºæ™¯åŒ…æ‹¬æ•°æ®åº“æŸ¥è¯¢ã€æ—¥ç¨‹ç®¡ç†ã€è®¡ç®—å™¨ç­‰éœ€è¦å‡†ç¡®æ•°æ®çš„ä»»åŠ¡ã€‚' },
            'ch07-quiz-4': { correct: '1', explanation: 'æ­£ç¡®ï¼åœ¨Function Callingä¸­ï¼ŒLLMåˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨å‡½æ•°ï¼Œå¹¶ä»ç”¨æˆ·è¾“å…¥ä¸­æå–å‡½æ•°å‚æ•°ã€‚LLMä¸ç›´æ¥æ‰§è¡Œå‡½æ•°ï¼Œè€Œæ˜¯è¿”å›ç»“æ„åŒ–çš„è°ƒç”¨ä¿¡æ¯ã€‚' }
        };

        document.querySelectorAll('.submit-quiz-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const container = btn.closest('.quiz-container');
                const selected = container.querySelector('.quiz-radio:checked');
                const feedback = container.querySelector('.quiz-feedback');
                const options = container.querySelectorAll('.quiz-option');

                if (!selected) {
                    alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆ');
                    return;
                }

                const quizId = container.getAttribute('data-quiz-id');
                const quiz = ch07QuizAnswers[quizId];

                feedback.classList.remove('correct', 'incorrect');
                feedback.classList.add('show');

                if (selected.value === quiz.correct) {
                    feedback.classList.add('correct');
                    feedback.innerHTML = `<strong>âœ“ å›ç­”æ­£ç¡®ï¼</strong><p>${quiz.explanation}</p>`;
                    options.forEach(opt => {
                        if (opt.querySelector('.quiz-radio').value === quiz.correct) {
                            opt.classList.add('correct');
                        }
                    });
                } else {
                    feedback.classList.add('incorrect');
                    feedback.innerHTML = `<strong>âœ— å›ç­”é”™è¯¯</strong><p>${quiz.explanation}</p>`;
                    options.forEach(opt => {
                        if (opt.querySelector('.quiz-radio').value === quiz.correct) {
                            opt.classList.add('correct');
                        } else if (opt.querySelector('.quiz-radio').checked) {
                            opt.classList.add('incorrect');
                        }
                    });
                }

                btn.disabled = true;
                btn.textContent = 'å·²å®Œæˆ';
            });
        });
    </script>
</body>
</html>
